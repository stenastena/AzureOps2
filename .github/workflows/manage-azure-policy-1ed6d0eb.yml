name: manage-azure-policy-1ed6d0eb
on:
  workflow_dispatch:
    inputs:
      remarks:
        description: 'Reason for triggering the workflow run'
        required: false
        default: 'Updating Azure Policies'


## Uncomment the following if you wish to automatically trigger workflow run with every commit
#
#  push:
#    paths:
#      - 'AzureMonitoring/policies/Deploy_Log_Analytics_agent_for_Linux_VMs_053d3325-282c-4e5c-b944-24faffd30d77/**'
#      - 'AzureMonitoring/policies/Azure_Monitor_log_profile_should_collect_logs_for_categories_write,_delete,_and_action_1a4e592a-6a6e-44a5-9814-e36264ca96e7/**'
#      - 'AzureMonitoring/policies/Azure_Monitor_should_collect_activity_logs_from_all_regions_41388f1c-2db0-4c25-95b2-35d7f5ccbfa9/**'
#      - 'AzureMonitoring/policies/Azure_Monitor_solution_Security_and_Audit_must_be_deployed_3e596b57-105f-48a6-be97-03e9243bad6e/**'
#      - 'AzureMonitoring/policies/Log_Analytics_agent_should_be_installed_on_your_virtual_machine_scale_sets_for_Azure_Security_Center_monitoring_a3a6ea0c-e018-4933-9ef0-5aaa1501449b/**'
#      - 'AzureMonitoring/policies/Log_Analytics_agent_should_be_installed_on_your_virtual_machine_for_Azure_Security_Center_monitoring_a4fe33eb-e377-4efb-ab31-0784311bc499/**'
#      - 'AzureMonitoring/policies/Monitor_missing_Endpoint_Protection_in_Azure_Security_Center_af6cd1bd-1635-48cb-bde7-5b15693900b9/**'
#      - 'AzureMonitoring/policies/_ASC_Private_Preview_Deploy_-_Configure_system-assigned_managed_identity_to_enable_Azure_Monitor_assignments_on_VMs_17b3de92-f710-4cf4-aa55-0e7859f1ed7b/**'
#      - 'AzureMonitoring/policies/_Preview_Deploy_-_Configure_Windows_Azure_Monitor_agent_to_enable_Azure_Monitor_assignments_on_Windows_virtual_machines_ca817e41-e85a-4783-bc7f-dc532d36235e/**'
#      - 'AzureMonitoring/policies/_Preview_Deploy_-_Configure_Linux_Azure_Monitor_agent_to_enable_Azure_Monitor_assignments_on_Linux_virtual_machines_a4034bc6-ae50-406d-bf76-50f4ee5a7811/**'
#      - 'AzureMonitoring/policies/Azure_Monitor_Logs_for_Application_Insights_should_be_linked_to_a_Log_Analytics_workspace_d550e854-df1a-4de9-bf44-cd894b39a95e/**'
#      - 'AzureMonitoring/policies/Azure_Monitor_Logs_clusters_should_be_encrypted_with_customer-managed_key_1f68a601-6e6d-4e42-babf-3f643a047ea2/**'
#      - 'AzureMonitoring/policies/Saved-queries_in_Azure_Monitor_should_be_saved_in_customer_storage_account_for_logs_encryption_fa298e57-9444-42ba-bf04-86e8470e32c7/**'
#      - 'AzureMonitoring/policies/Azure_Monitor_Logs_clusters_should_be_created_with_infrastructure-encryption_enabled_(double_encryption)_ea0dfaed-95fb-448c-934e-d6e713ce393d/**'
#      - 'AzureMonitoring/policies/Deploy_Log_Analytics_agent_for_Linux_virtual_machine_scale_sets_5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069/**'
#      - 'AzureMonitoring/policies/Auto_provisioning_of_the_Log_Analytics_agent_should_be_enabled_on_your_subscription_475aae12-b88a-4572-8b36-9b712b2b3a17/**'
#      - 'AzureMonitoring/policies/Deploy_export_to_Log_Analytics_workspace_for_Azure_Security_Center_data_ffb6f416-7bd2-4488-8828-56585fef2be9/**'
#      - 'AzureMonitoring/policies/An_activity_log_alert_should_exist_for_specific_Policy_operations_c5447c04-a4d7-4ba8-a263-c9ee321a6858/**'
#      - 'AzureMonitoring/policies/Activity_log_should_be_retained_for_at_least_one_year_b02aacc0-b073-424e-8298-42b22829ee0a/**'
#      - 'AzureMonitoring/policies/An_activity_log_alert_should_exist_for_specific_Administrative_operations_b954148f-4c11-4c38-8221-be76711e194a/**'
#      - 'AzureMonitoring/policies/An_activity_log_alert_should_exist_for_specific_Security_operations_3b980d31-7904-4bb7-8575-5665739a8052/**'
#      - 'AzureMonitoring/policies/Diagnostic_logs_in_App_Services_should_be_enabled_b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0/**'
#      - 'AzureMonitoring/policies/Diagnostic_logs_in_Key_Vault_should_be_enabled_cf820ca0-f99e-4f3e-84fb-66e913812d21/**'
#      - 'AzureMonitoring/policies/Deploy_Log_Analytics_agent_for_Windows_virtual_machine_scale_sets_3c1b3629-c8f8-4bf6-862c-037cb9094038/**'
#      - 'AzureMonitoring/policies/Deploy_Log_Analytics_agent_for_Windows_VMs_0868462e-646c-4fe3-9ced-a733534b6a2c/**'
#      - 'AzureMonitoring/policies/_Preview_Audit_Log_Analytics_Agent_Deployment_-_VM_Image_(OS)_unlisted_32133ab0-ee4b-4b44-98d6-042180979d50/**'
#      - 'AzureMonitoring/policies/Audit_Log_Analytics_workspace_for_VM_-_Report_Mismatch_f47b5582-33ec-4c5c-87c0-b010a6b2e917/**'
#      - 'AzureMonitoring/policies/Diagnostic_logs_in_Logic_Apps_should_be_enabled_34f95f76-5386-4de7-b824-0d8478470c9d/**'
#      - 'AzureMonitoring/policies/Audit_Log_Analytics_agent_deployment_in_virtual_machine_scale_sets_-_VM_Image_(OS)_unlisted_5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138/**'
#      - 'AzureMonitoring/policies/Azure_subscriptions_should_have_a_log_profile_for_Activity_Log_7796937f-307b-4598-941c-67d3a05ebfe7/**'
#      - 'AzureMonitoring/policies/Flow_log_should_be_configured_for_every_network_security_group_c251913d-7d24-4958-af87-478ed3b9ba41/**'
#      - 'AzureMonitoring/policies/Deploy_a_flow_log_resource_with_target_network_security_group_0db34a60-64f4-4bf6-bd44-f95c16cf34b9/**'
#      - 'AzureMonitoring/policies/Log_checkpoints_should_be_enabled_for_PostgreSQL_database_servers_eb6f77b9-bd53-4e35-a23d-7f65d5f0e43d/**'
#      - 'AzureMonitoring/policies/Log_connections_should_be_enabled_for_PostgreSQL_database_servers_eb6f77b9-bd53-4e35-a23d-7f65d5f0e442/**'
#      - 'AzureMonitoring/policies/Disconnections_should_be_logged_for_PostgreSQL_database_servers._eb6f77b9-bd53-4e35-a23d-7f65d5f0e446/**'
#      - 'AzureMonitoring/policies/Log_duration_should_be_enabled_for_PostgreSQL_database_servers_eb6f77b9-bd53-4e35-a23d-7f65d5f0e8f3/**'
#      - 'AzureMonitoring/policies/Diagnostic_logs_in_Virtual_Machine_Scale_Sets_should_be_enabled_7c1b1214-f927-48bf-8882-84f0af6588b1/**'
#      - 'AzureMonitoring/policies/Diagnostic_logs_in_Azure_Stream_Analytics_should_be_enabled_f9be5368-9bf5-4b84-9e0a-7850da98bb46/**'
#      - 'AzureMonitoring/policies/Enable_Security_Center_s_auto_provisioning_of_the_Log_Analytics_agent_on_your_subscriptions_with_default_workspace._6df2fee6-a9ed-4fef-bced-e13be1b25f1c/**'
#      - 'AzureMonitoring/policies/Enable_Security_Center_s_auto_provisioning_of_the_Log_Analytics_agent_on_your_subscriptions_with_custom_workspace._8e7da0a5-0a0e-4bbc-bfc0-7773c018b616/**'
#      - 'AzureMonitoring/policies/Windows_machines_should_meet_requirements_for_Security_Options_-_Interactive_Logon_d472d2c9-d6a3-4500-9f5f-b15f123005aa/**'
#      - 'AzureMonitoring/policies/Windows_machines_should_meet_requirements_for_System_Audit_Policies_-_Account_Logon_43bb60fe-1d7e-4b82-9e93-496bfc99e7d5/**'
#      - 'AzureMonitoring/policies/Windows_machines_should_meet_requirements_for_System_Audit_Policies_-_Logon-Logoff_19be9779-c776-4dfa-8a15-a2fd5dc843d6/**'
#      - 'AzureMonitoring/policies/Deploy_-_Configure_diagnostic_settings_for_Azure_SQL_Database_server_to_Log_Analytics_workspace_7ea8a143-05e3-4553-abfe-f56bef8b0b70/**'
#      - 'AzureMonitoring/policies/Deploy_-_Configure_diagnostic_settings_for_SQL_Databases_to_Log_Analytics_workspace_b79fa14e-238a-4c2d-b376-442ce508fc84/**'
#      - 'AzureMonitoring/policies/Deploy_-_Configure_diagnostic_settings_to_a_Log_Analytics_workspace_to_be_enabled_on_Azure_Key_Vault_Managed_HSM_b3884c81-31aa-473d-a9bb-9466fe0ec2a0/**'
#      - 'AzureMonitoring/initiatives/Enable_Azure_Monitor_for_VMs_55f3eceb-5573-4f18-9695-226972c6d74a/**'
#      - 'AzureMonitoring/initiatives/Enable_Azure_Monitor_for_Virtual_Machine_Scale_Sets_75714362-cae7-409e-9b99-a8e5075b7fad/**'
#      - 'AzureMonitoring/initiatives/_Preview_Deploy_-_Configure_prerequisites_to_enable_Azure_Monitor_and_Azure_Security_agents_on_virtual_machines_a15f3269-2e10-458c-87a4-d5989e678a73/**'
#      - .github/workflows/manage-azure-policy-1ed6d0eb.yml
jobs:
  apply-azure-policy:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - name: Login to Azure
      uses: azure/login@v1
      with:
        creds: ${{secrets.AZURE_CREDENTIALS_1ed6d0eb}}
        allow-no-subscriptions: true
    - name: Create or Update Azure Policies
      uses: azure/manage-azure-policy@v0
      with:
        paths: |
          AzureMonitoring/policies/Deploy_Log_Analytics_agent_for_Linux_VMs_053d3325-282c-4e5c-b944-24faffd30d77/**
          AzureMonitoring/policies/Azure_Monitor_log_profile_should_collect_logs_for_categories_write,_delete,_and_action_1a4e592a-6a6e-44a5-9814-e36264ca96e7/**
          AzureMonitoring/policies/Azure_Monitor_should_collect_activity_logs_from_all_regions_41388f1c-2db0-4c25-95b2-35d7f5ccbfa9/**
          AzureMonitoring/policies/Azure_Monitor_solution_Security_and_Audit_must_be_deployed_3e596b57-105f-48a6-be97-03e9243bad6e/**
          AzureMonitoring/policies/Log_Analytics_agent_should_be_installed_on_your_virtual_machine_scale_sets_for_Azure_Security_Center_monitoring_a3a6ea0c-e018-4933-9ef0-5aaa1501449b/**
          AzureMonitoring/policies/Log_Analytics_agent_should_be_installed_on_your_virtual_machine_for_Azure_Security_Center_monitoring_a4fe33eb-e377-4efb-ab31-0784311bc499/**
          AzureMonitoring/policies/Monitor_missing_Endpoint_Protection_in_Azure_Security_Center_af6cd1bd-1635-48cb-bde7-5b15693900b9/**
          AzureMonitoring/policies/_ASC_Private_Preview_Deploy_-_Configure_system-assigned_managed_identity_to_enable_Azure_Monitor_assignments_on_VMs_17b3de92-f710-4cf4-aa55-0e7859f1ed7b/**
          AzureMonitoring/policies/_Preview_Deploy_-_Configure_Windows_Azure_Monitor_agent_to_enable_Azure_Monitor_assignments_on_Windows_virtual_machines_ca817e41-e85a-4783-bc7f-dc532d36235e/**
          AzureMonitoring/policies/_Preview_Deploy_-_Configure_Linux_Azure_Monitor_agent_to_enable_Azure_Monitor_assignments_on_Linux_virtual_machines_a4034bc6-ae50-406d-bf76-50f4ee5a7811/**
          AzureMonitoring/policies/Azure_Monitor_Logs_for_Application_Insights_should_be_linked_to_a_Log_Analytics_workspace_d550e854-df1a-4de9-bf44-cd894b39a95e/**
          AzureMonitoring/policies/Azure_Monitor_Logs_clusters_should_be_encrypted_with_customer-managed_key_1f68a601-6e6d-4e42-babf-3f643a047ea2/**
          AzureMonitoring/policies/Saved-queries_in_Azure_Monitor_should_be_saved_in_customer_storage_account_for_logs_encryption_fa298e57-9444-42ba-bf04-86e8470e32c7/**
          AzureMonitoring/policies/Azure_Monitor_Logs_clusters_should_be_created_with_infrastructure-encryption_enabled_(double_encryption)_ea0dfaed-95fb-448c-934e-d6e713ce393d/**
          AzureMonitoring/policies/Deploy_Log_Analytics_agent_for_Linux_virtual_machine_scale_sets_5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069/**
          AzureMonitoring/policies/Auto_provisioning_of_the_Log_Analytics_agent_should_be_enabled_on_your_subscription_475aae12-b88a-4572-8b36-9b712b2b3a17/**
          AzureMonitoring/policies/Deploy_export_to_Log_Analytics_workspace_for_Azure_Security_Center_data_ffb6f416-7bd2-4488-8828-56585fef2be9/**
          AzureMonitoring/policies/An_activity_log_alert_should_exist_for_specific_Policy_operations_c5447c04-a4d7-4ba8-a263-c9ee321a6858/**
          AzureMonitoring/policies/Activity_log_should_be_retained_for_at_least_one_year_b02aacc0-b073-424e-8298-42b22829ee0a/**
          AzureMonitoring/policies/An_activity_log_alert_should_exist_for_specific_Administrative_operations_b954148f-4c11-4c38-8221-be76711e194a/**
          AzureMonitoring/policies/An_activity_log_alert_should_exist_for_specific_Security_operations_3b980d31-7904-4bb7-8575-5665739a8052/**
          AzureMonitoring/policies/Diagnostic_logs_in_App_Services_should_be_enabled_b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0/**
          AzureMonitoring/policies/Diagnostic_logs_in_Key_Vault_should_be_enabled_cf820ca0-f99e-4f3e-84fb-66e913812d21/**
          AzureMonitoring/policies/Deploy_Log_Analytics_agent_for_Windows_virtual_machine_scale_sets_3c1b3629-c8f8-4bf6-862c-037cb9094038/**
          AzureMonitoring/policies/Deploy_Log_Analytics_agent_for_Windows_VMs_0868462e-646c-4fe3-9ced-a733534b6a2c/**
          AzureMonitoring/policies/_Preview_Audit_Log_Analytics_Agent_Deployment_-_VM_Image_(OS)_unlisted_32133ab0-ee4b-4b44-98d6-042180979d50/**
          AzureMonitoring/policies/Audit_Log_Analytics_workspace_for_VM_-_Report_Mismatch_f47b5582-33ec-4c5c-87c0-b010a6b2e917/**
          AzureMonitoring/policies/Diagnostic_logs_in_Logic_Apps_should_be_enabled_34f95f76-5386-4de7-b824-0d8478470c9d/**
          AzureMonitoring/policies/Audit_Log_Analytics_agent_deployment_in_virtual_machine_scale_sets_-_VM_Image_(OS)_unlisted_5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138/**
          AzureMonitoring/policies/Azure_subscriptions_should_have_a_log_profile_for_Activity_Log_7796937f-307b-4598-941c-67d3a05ebfe7/**
          AzureMonitoring/policies/Flow_log_should_be_configured_for_every_network_security_group_c251913d-7d24-4958-af87-478ed3b9ba41/**
          AzureMonitoring/policies/Deploy_a_flow_log_resource_with_target_network_security_group_0db34a60-64f4-4bf6-bd44-f95c16cf34b9/**
          AzureMonitoring/policies/Log_checkpoints_should_be_enabled_for_PostgreSQL_database_servers_eb6f77b9-bd53-4e35-a23d-7f65d5f0e43d/**
          AzureMonitoring/policies/Log_connections_should_be_enabled_for_PostgreSQL_database_servers_eb6f77b9-bd53-4e35-a23d-7f65d5f0e442/**
          AzureMonitoring/policies/Disconnections_should_be_logged_for_PostgreSQL_database_servers._eb6f77b9-bd53-4e35-a23d-7f65d5f0e446/**
          AzureMonitoring/policies/Log_duration_should_be_enabled_for_PostgreSQL_database_servers_eb6f77b9-bd53-4e35-a23d-7f65d5f0e8f3/**
          AzureMonitoring/policies/Diagnostic_logs_in_Virtual_Machine_Scale_Sets_should_be_enabled_7c1b1214-f927-48bf-8882-84f0af6588b1/**
          AzureMonitoring/policies/Diagnostic_logs_in_Azure_Stream_Analytics_should_be_enabled_f9be5368-9bf5-4b84-9e0a-7850da98bb46/**
          AzureMonitoring/policies/Enable_Security_Center_s_auto_provisioning_of_the_Log_Analytics_agent_on_your_subscriptions_with_default_workspace._6df2fee6-a9ed-4fef-bced-e13be1b25f1c/**
          AzureMonitoring/policies/Enable_Security_Center_s_auto_provisioning_of_the_Log_Analytics_agent_on_your_subscriptions_with_custom_workspace._8e7da0a5-0a0e-4bbc-bfc0-7773c018b616/**
          AzureMonitoring/policies/Windows_machines_should_meet_requirements_for_Security_Options_-_Interactive_Logon_d472d2c9-d6a3-4500-9f5f-b15f123005aa/**
          AzureMonitoring/policies/Windows_machines_should_meet_requirements_for_System_Audit_Policies_-_Account_Logon_43bb60fe-1d7e-4b82-9e93-496bfc99e7d5/**
          AzureMonitoring/policies/Windows_machines_should_meet_requirements_for_System_Audit_Policies_-_Logon-Logoff_19be9779-c776-4dfa-8a15-a2fd5dc843d6/**
          AzureMonitoring/policies/Deploy_-_Configure_diagnostic_settings_for_Azure_SQL_Database_server_to_Log_Analytics_workspace_7ea8a143-05e3-4553-abfe-f56bef8b0b70/**
          AzureMonitoring/policies/Deploy_-_Configure_diagnostic_settings_for_SQL_Databases_to_Log_Analytics_workspace_b79fa14e-238a-4c2d-b376-442ce508fc84/**
          AzureMonitoring/policies/Deploy_-_Configure_diagnostic_settings_to_a_Log_Analytics_workspace_to_be_enabled_on_Azure_Key_Vault_Managed_HSM_b3884c81-31aa-473d-a9bb-9466fe0ec2a0/**
          AzureMonitoring/initiatives/Enable_Azure_Monitor_for_VMs_55f3eceb-5573-4f18-9695-226972c6d74a/**
          AzureMonitoring/initiatives/Enable_Azure_Monitor_for_Virtual_Machine_Scale_Sets_75714362-cae7-409e-9b99-a8e5075b7fad/**
          AzureMonitoring/initiatives/_Preview_Deploy_-_Configure_prerequisites_to_enable_Azure_Monitor_and_Azure_Security_agents_on_virtual_machines_a15f3269-2e10-458c-87a4-d5989e678a73/**
